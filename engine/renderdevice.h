#ifndef _renderdevice_h_
#define _renderdevice_h_

//////////////////////////////////////////////////////////////////////////////
//
// IRenderDevice — backend-agnostic rendering device interface
//
// Combines surface creation, device caps, texture management, and
// scene begin/end into a single interface that can be implemented by
// either the legacy DX7 backend (DDDevice + D3DDevice) or the new
// DX9 backend.
//
//////////////////////////////////////////////////////////////////////////////

class IRenderDevice : public IObject {
public:
    //////////////////////////////////////////////////////////////////////////////
    //
    // Lifetime
    //
    //////////////////////////////////////////////////////////////////////////////

    virtual void Terminate()      = 0;
    virtual void FreeEverything()  = 0;

    //////////////////////////////////////////////////////////////////////////////
    //
    // Device information
    //
    //////////////////////////////////////////////////////////////////////////////

    virtual ZString GetName()               = 0;
    virtual bool    Has3DAcceleration()      = 0;
    virtual bool    GetAllow3DAcceleration() = 0;
    virtual void    SetAllow3DAcceleration(bool bAllow) = 0;

    //////////////////////////////////////////////////////////////////////////////
    //
    // Display modes
    //
    //////////////////////////////////////////////////////////////////////////////

    virtual WinPoint NextMode(const WinPoint& size)     = 0;
    virtual WinPoint PreviousMode(const WinPoint& size) = 0;
    virtual void     EliminateModes(const WinPoint& size) = 0;

    //////////////////////////////////////////////////////////////////////////////
    //
    // Memory queries
    //
    //////////////////////////////////////////////////////////////////////////////

    virtual int GetTotalTextureMemory()     = 0;
    virtual int GetAvailableTextureMemory() = 0;
    virtual int GetTotalVideoMemory()       = 0;
    virtual int GetAvailableVideoMemory()   = 0;

    //////////////////////////////////////////////////////////////////////////////
    //
    // Texture management
    //
    //////////////////////////////////////////////////////////////////////////////

    virtual PixelFormat* GetTextureFormat()      = 0;
    virtual WinPoint     GetMinTextureSize()     = 0;
    virtual WinPoint     GetMaxTextureSize()     = 0;
    virtual bool         IsHardwareAccelerated() = 0;

    //////////////////////////////////////////////////////////////////////////////
    //
    // Scene management
    //
    //////////////////////////////////////////////////////////////////////////////

    virtual void BeginScene() = 0;
    virtual void EndScene()   = 0;

    //////////////////////////////////////////////////////////////////////////////
    //
    // Cooperative level (DX7: TestCooperativeLevel, DX9: TestCooperativeLevel)
    //
    //////////////////////////////////////////////////////////////////////////////

    virtual HRESULT TestCooperativeLevel() = 0;
};

#endif
